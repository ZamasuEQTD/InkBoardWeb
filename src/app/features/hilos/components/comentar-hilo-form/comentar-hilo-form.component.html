<div class="w-full px-2 py-2 bg-white border-solid border-t-2 border-gray-300 relative pt-4">
  <form action="" [formGroup]="this.form" (submit)="$event.preventDefault()">

    <app-pick-file-input #fileRef hidden  (onPickedFile)="this.agregarMedia($event)"/>

    <input formControlName="spoiler" type="checkbox" #spoilerRef hidden>

    @if (this.media) {

      @if (this.media!.type === 'video' || this.media!.type === 'image' || this.media!.type === 'youtube') {

        <div class="inline-flex mb-2 relative">

          <div class="sm:size-28  size-24 inline-flex rounded-s bg-gray-200 p-2 rounded-xl overflow-hidden">

            <div class="rounded-lg overflow-hidden flex justify-center h-full w-full relative object-cover">

              @switch (this.media!.type) {
                @case ('image') {
                  <img  class="rounded-md" [src]="this.media!.source" alt="">
                }
                @case ('video') {
                  <video class="rounded-md" [src]="this.media!.source"></video>
                }
                @case ('youtube') {
                  <img  class="rounded-md" [src]='this.media!.source | youtubeThumbnail' alt="">
                }
              }

              @if (this.spoiler) {
                <div class="absolute w-full h-full  top-0 right-0 bg-black-100 bg-opacity-20 backdrop-blur-lg rounded-md"></div>
              }

            </div>

            <div class="flex flex-row absolute top-[-10px] right-1 bg-white shadow-lg rounded-md">
              <button class="size-8 flex justify-center items-center"  (click)="spoilerRef.click()">
                <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye"><path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"/><circle cx="12" cy="12" r="3"/></svg>
              </button>

              <button class="size-8 flex justify-center items-center" (click)="this.eliminarMedia()">
                <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>
              </button>

            </div>
          </div>

        </div>

      } @else {

      }
    }


    <div class="flex flex-row gap-x-2 items-center ">

      <div class="rounded-md bg-gray-200 flex-1 flex flex-row items-center p-2 box-border ">

        <div class="flex flex-row flex-1 gap-x-1">

          <button class="size-8  flex justify-center items-center"  (click)="fileRef.pick()" type="button">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bolt"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><circle cx="12" cy="12" r="4"/></svg>
          </button>

          <textarea formControlName="texto"  #myTextareaRef rows="3" name="" id="" placeholder="Escribe tu comentario" class="flex-1 p-0 rounded-none"></textarea>

        </div>

        <button class="size-8 flex justify-center items-center text-gray-800" (click)="$event.preventDefault()" type="submit">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
            <path d="M3.105 2.288a.75.75 0 0 0-.826.95l1.414 4.926A1.5 1.5 0 0 0 5.135 9.25h6.115a.75.75 0 0 1 0 1.5H5.135a1.5 1.5 0 0 0-1.442 1.086l-1.414 4.926a.75.75 0 0 0 .826.95 28.897 28.897 0 0 0 15.293-7.155.75.75 0 0 0 0-1.114A28.897 28.897 0 0 0 3.105 2.288Z" />
          </svg>
        </button>

      </div>


    </div>

  </form>

</div>
